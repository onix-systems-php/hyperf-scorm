
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SCORM Player</title>
  <link rel="stylesheet" href="assets/css/style.css">
  <script src="assets/js/simple-scorm-api.js"></script>
</head>
<body>
<div class="player-container">
  <div class="player-header">
    <h1>SCORM Player</h1>
    <div class="player-info">
      <span>Course: <?php echo htmlspecialchars($courseId); ?></span>
      <span>Learner: <?php echo htmlspecialchars($learnerName); ?></span>
    </div>
    <div class="player-controls">
      <button onclick="refreshContent()">Refresh</button>
      <button onclick="exitCourse()">Exit Course</button>
    </div>
  </div>

  <div class="player-content">
    <iframe id="scormFrame" src="<?php echo htmlspecialchars($launchUrl); ?>"
            width="100%" height="100%" frameborder="0">
    </iframe>
  </div>
</div>

<script>
  window.courseId = '<?php echo htmlspecialchars($courseId); ?>';
  window.learnerName = '<?php echo htmlspecialchars($learnerName); ?>';
  window.learnerId = '<?php echo htmlspecialchars($learnerId); ?>';
  window.manifestObjectives = <?php echo json_encode($objectives); ?>;

  function refreshContent() {
    document.getElementById('scormFrame').src = document.getElementById('scormFrame').src;
  }

  function exitCourse() {
    if (window.API && typeof window.API.LMSFinish === 'function') {
      window.API.LMSFinish('');
    }
    window.location.href = 'index.php';
  }

  window.addEventListener('beforeunload', function(e) {
    if (window.API && typeof window.API.LMSFinish === 'function') {
      window.API.LMSFinish('');
    }
  });

  function getAPI() {
    return window.API;
  }

  function getAPI_1484_11() {
    return window.API_1484_11;
  }

  window.parent.getAPI = getAPI;
  window.parent.getAPI_1484_11 = getAPI_1484_11;
</script>
</body>
</html>
